rules:
  - id: hardcoded-api-key
    pattern-either:
      - pattern: |
          $API_KEY = "..."
      - pattern: |
          const $API_KEY = "..."
      - pattern: |
          let $API_KEY = "..."
      - pattern: |
          var $API_KEY = "..."
    message: "Hardcoded API key detected. Store secrets in environment variables or secure configuration."
    languages:
      - javascript
      - typescript
    severity: WARNING
    metadata:
      category: security
      subcategory: secrets

  - id: hardcoded-password
    pattern-either:
      - pattern: |
          $PASSWORD = "..."
      - pattern: |
          const $PASSWORD = "..."
      - pattern: |
          let $PASSWORD = "..."
      - pattern: |
          var $PASSWORD = "..."
    message: "Hardcoded password detected. Use secure credential storage instead."
    languages:
      - javascript
      - typescript
    severity: ERROR
    metadata:
      category: security
      subcategory: secrets

  - id: sql-injection-risk
    pattern: |
      $QUERY = "SELECT * FROM " + $USER_INPUT
    message: "Potential SQL injection vulnerability. Use parameterized queries instead."
    languages:
      - javascript
      - typescript
    severity: ERROR
    metadata:
      category: security
      subcategory: injection
